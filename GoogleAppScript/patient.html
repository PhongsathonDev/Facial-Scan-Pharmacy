<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <title>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #b2f0d4, #e0fff4);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: start;
      padding: 2rem;
      color: #064e3b;
      overflow-x: hidden;
    }

    .glass-box {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(95, 201, 155, 0.3);
      box-shadow: 0 12px 40px rgba(95, 201, 155, 0.2);
      transition: all 0.4s ease;
    }

    .glass-box:hover {
      transform: translateY(-6px);
      box-shadow: 0 16px 50px rgba(95, 201, 155, 0.3);
    }

    th {
      background: linear-gradient(to right, #25b77a, #7ce5b8);
      color: white;
      font-weight: 600;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    tr:hover {
      background-color: #e8fff3;
      transition: background 0.25s ease-in-out;
    }

    button {
      transition: all 0.3s ease;
    }

    button:hover {
      transform: translateY(-2px) scale(1.05);
    }

    #loading {
      animation: pulse 1.2s infinite;
      color: #22a676;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 0.5;
        transform: scale(0.98);
      }

      50% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .bubble {
      position: fixed;
      bottom: -50px;
      width: 20px;
      height: 20px;
      background: rgba(46, 204, 113, 0.25);
      border-radius: 50%;
      animation: floatUp 8s infinite ease-in;
      z-index: 0;
    }

    @keyframes floatUp {
      from {
        transform: translateY(0) scale(1);
        opacity: 0.7;
      }

      to {
        transform: translateY(-120vh) scale(1.3);
        opacity: 0;
      }
    }
  </style>
</head>

<body>

  <!-- üåø ‡∏•‡∏≠‡∏¢‡∏ü‡∏≠‡∏á -->
  <div class="bubble" style="left:10%; animation-delay: 0s;"></div>
  <div class="bubble" style="left:25%; width:25px; height:25px; animation-delay: 2s;"></div>
  <div class="bubble" style="left:50%; width:15px; height:15px; animation-delay: 4s;"></div>
  <div class="bubble" style="left:70%; width:30px; height:30px; animation-delay: 1s;"></div>
  <div class="bubble" style="left:90%; width:20px; height:20px; animation-delay: 3s;"></div>

  <!-- üîπ Header -->
  <header
    class="fixed top-0 left-0 w-full bg-white/70 backdrop-blur-lg shadow-lg py-3 px-6 flex justify-between items-center border-b border-green-200 z-10">
    <h1 class="text-2xl font-semibold text-green-700 flex items-center gap-2">
      üíä ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ
    </h1>
    <button id="logoutBtn"
      class="px-4 py-2 rounded-lg bg-gradient-to-r from-green-400 to-green-600 text-white font-medium hover:from-green-500 hover:to-green-700 shadow-md">
      üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </button>
  </header>

  <!-- üîπ Main content -->
  <div class="max-w-7xl w-full glass-box mt-28 p-8 rounded-3xl grid grid-cols-1 md:grid-cols-2 gap-8 relative z-10">

    <!-- üßç‚Äç‚ôÇÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ -->
    <div
      class="bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-2xl p-6 shadow-inner hover:shadow-lg transition">
      <div class="flex items-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600 mr-2 animate-bounce" fill="none"
          viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M5.121 17.804A9 9 0 1118.88 6.197a9 9 0 01-13.758 11.607z" />
        </svg>
        <h2 class="text-2xl font-bold text-green-700 drop-shadow">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h2>
      </div>

      <div class="flex items-center gap-5">
        <img id="pPhoto"
          src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTkd1v042iQAqA8lTPkQ0N0ZxIcIDtZt6-Yhg&s"
          alt="‡∏£‡∏π‡∏õ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢"
          class="w-28 h-28 rounded-full border-4 border-green-300 shadow-md hover:scale-105 transition duration-300">
        <div class="space-y-3 text-gray-700 leading-relaxed">
          <p><span class="font-semibold text-green-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</span> <span id="pName">‡∏ô‡∏≤‡∏¢ ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ</span></p>
          <p><span class="font-semibold text-green-600">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢:</span> <span id="pCode">TB001</span></p>
          <p><span class="font-semibold text-green-600">‡∏≠‡∏≤‡∏¢‡∏∏:</span> <span id="pAge">45 ‡∏õ‡∏µ</span></p>
          <p><span class="font-semibold text-green-600">‡πÄ‡∏û‡∏®:</span> <span id="pGender">‡∏ä‡∏≤‡∏¢</span></p>
        </div>
      </div>

      <div class="mt-4 text-gray-700 leading-relaxed">
        <p><span class="font-semibold text-green-600">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</span> <span id="pAddress">123 ‡∏´‡∏°‡∏π‡πà 4 ‡∏ï.‡∏ö‡∏∏‡πà‡∏á ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á
            ‡∏à.‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç</span></p>
        <p><span class="font-semibold text-green-600">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</span> <span id="pPhone">081-234-5678</span></p>
        <p><span class="font-semibold text-green-600">‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•:</span> <span id="HName">‡∏ô‡∏≤‡∏¢‡∏®‡∏¥‡∏£‡∏¥‡∏û‡∏£ ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏ä‡∏±‡∏¢</span>
        </p>
      </div>
    </div>

    <!-- üíä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° -->
    <div>
      <div class="flex items-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600 mr-2 animate-pulse" fill="none"
          viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z" />
        </svg>
        <h2 class="text-2xl font-bold text-green-700 drop-shadow">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤</h2>
      </div>

      <div class="overflow-x-auto border border-green-200 rounded-xl shadow-md">
        <table class="w-full border-collapse text-center text-gray-700">
          <thead>
            <tr>
              <th class="p-3 border border-green-200">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
              <th class="p-3 border border-green-200">‡πÄ‡∏ß‡∏•‡∏≤</th>
            </tr>
          </thead>
          <tbody id="tableBody" class="divide-y divide-green-100 bg-white"></tbody>
        </table>
      </div>

      <div class="flex justify-center items-center gap-4 mt-5">
        <button id="prevBtn"
          class="px-4 py-2 rounded-lg bg-gradient-to-r from-green-300 to-green-500 text-white font-medium hover:from-green-400 hover:to-green-600 shadow-md">‚¨ÖÔ∏è
          ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
        <span id="pageInfo" class="text-green-700 font-semibold"></span>
        <button id="nextBtn"
          class="px-4 py-2 rounded-lg bg-gradient-to-r from-green-300 to-green-500 text-white font-medium hover:from-green-400 hover:to-green-600 shadow-md">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
          ‚û°Ô∏è</button>
      </div>

      <div id="loading" class="text-center mt-4 font-medium">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
    </div>
  </div>

  <script>
    let allData = [];
    let currentPage = 1;
    const rowsPerPage = 6;

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet
    function fetchData() {
      google.script.run.withSuccessHandler(showPatientData).getPatientData();
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    function showPatientData(data) {
      const tbody = document.getElementById('tableBody');
      const loading = document.getElementById('loading');
      loading.style.display = 'none';

      if (!data || data.length === 0 || data[0].error) {
        allData = [];
        currentPage = 1;
        tbody.innerHTML = `<tr><td colspan="2" class="text-red-500 py-4">‚ö†Ô∏è ${data[0]?.error || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'}</td></tr>`;
        document.getElementById('pageInfo').textContent = '';
        return;
      }

      allData = data;

      // ‡∏õ‡∏£‡∏±‡∏ö currentPage ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      const totalPages = Math.ceil(allData.length / rowsPerPage);
      if (currentPage > totalPages) currentPage = totalPages || 1;

      renderTable();
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function renderTable() {
      const tbody = document.getElementById('tableBody');
      tbody.innerHTML = "";

      if (allData.length === 0) {
        tbody.innerHTML = `<tr><td colspan="2" class="text-red-500 py-4">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
        document.getElementById('pageInfo').textContent = '';
        return;
      }

      const start = (currentPage - 1) * rowsPerPage;
      const end = start + rowsPerPage;
      const pageData = allData.slice(start, end);

      pageData.forEach(row => {
        const tr = document.createElement('tr');
        tr.classList.add("hover:bg-green-50");
        tr.innerHTML = `
      <td class="border border-green-100 p-3">${row['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'] || '-'}</td>
      <td class="border border-green-100 p-3">${row['‡πÄ‡∏ß‡∏•‡∏≤'] || '-'}</td>
    `;
        tbody.appendChild(tr);
      });

      const totalPages = Math.ceil(allData.length / rowsPerPage);
      document.getElementById('pageInfo').textContent = `‡∏´‡∏ô‡πâ‡∏≤ ${currentPage} ‡∏à‡∏≤‡∏Å ${totalPages}`;
    }

    // ‡∏õ‡∏∏‡πà‡∏° pagination
    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentPage > 1) { currentPage--; renderTable(); }
    });
    document.getElementById('nextBtn').addEventListener('click', () => {
      const totalPages = Math.ceil(allData.length / rowsPerPage);
      if (currentPage < totalPages) { currentPage++; renderTable(); }
    });

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    fetchData();
    setInterval(fetchData, 10000);

    // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    function logout() {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        sessionStorage.removeItem('userFullName');
        if (typeof google !== 'undefined' && google.script && google.script.run) {
          google.script.run.withSuccessHandler((url) => {
            const baseUrl = url.split('?')[0];
            window.top.location.href = baseUrl + '?page=index';
          }).getWebAppUrl();
        } else {
          window.location.href = 'index.html';
        }
      }
    }
    document.getElementById('logoutBtn').addEventListener('click', logout);
  </script>

</body>

</html>